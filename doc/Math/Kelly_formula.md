---
title: Kelly Formula
parent: Math
has_children: false
nav_order: 1
---

# 凱利公式 Kelly Formula  

假設一場賭局，勝率為$p$，輸的機率為$q=(1-p)$，賠率(獲勝時可得到的報酬率，不含本金)是$b$，則參與這場賭局每次應該下注的本金比例$f$，可以最大化本金的長期增長率:  

$$ f = \frac{b \times p - q} {b} $$  

舉例: 假設一個賭局，有60%的獲勝機率($p=0.6, q=0.4$)，獲勝時可以獲得1倍的報酬(b=1)，則每次應該下注的金額比例是  
$$ f = \frac {1 \times 0.6 - 0.4}{1}=0.2 $$  
以最大化資金的長期增長率  


若賠率$b$太低，$b<q/p$，則$f<0$，不應該下注。  
 

## 凱利公式的變形  

假設一場賭局，有$p$的機率，可贏得$W$比例的本金(淨贏率)；有$q$的機率會賠掉$L$比例的本金(淨損率)，則參與這場賭局每次應該下注的本金比例 $f$，可以最大化本金的長期增長率:  

$$ f = \frac {p \times W - q \times L} {W \times L} $$  

舉例:  
假設一項投資，有50%的機率賺25%，有50%的機率賠20%，則我應該投入的資金比例為:  

$$ f = \frac {0.5 \times 0.25 - 0.5 \times 0.2} {0.25 \times 0.2} = 0.5=50\% $$  


## 實務上的考量  

交易策略的勝率來自過去的回測，回測的區間大小、回測的時間都不同、因此得到的勝率跟盈虧比率在不同的回測參數上都不會是一個固定值。  

若交易測落的穩定性不錯，則不同參數下求得的勝率跟盈虧比率標準差較小，此時凱利公式的參考性較高。  

凱利公式的基本原則是，當期望值越高時，投入的部位才會放大，否則相對保守，藉此保全在市場上的存活率，長期才有獲勝的可能。  